<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ AI Trading System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        function TradingApp() {
            const [tab, setTab] = useState('dashboard');
            const [assetClass, setAssetClass] = useState('stocks');
            const [signals, setSignals] = useState([]);
            const [marketData, setMarketData] = useState({});
            const [news, setNews] = useState([]);
            const [aiResponse, setAiResponse] = useState('');
            const [aiPrompt, setAiPrompt] = useState('');
            const [backTestData, setBackTestData] = useState(null);
            const [riskMetrics, setRiskMetrics] = useState({});

            const stocks = ['AAPL', 'GOOGL', 'MSFT', 'TSLA', 'NVDA'];
            const forex = ['EUR/USD', 'GBP/USD', 'USD/JPY', 'AUD/USD', 'USD/CAD'];
            const commodities = ['GOLD', 'CRUDE_OIL', 'SILVER', 'COPPER', 'WHEAT'];
            const crypto = ['BTC/USD', 'ETH/USD', 'BNB/USD', 'SOL/USD', 'ADA/USD'];

            const [watchlist, setWatchlist] = useState(stocks);

            const calculateRSI = (prices) => {
                if (prices.length < 14) return 50;
                let gains = 0, losses = 0;
                for (let i = 1; i < 14; i++) {
                    const change = prices[i] - prices[i - 1];
                    if (change > 0) gains += change;
                    else losses -= change;
                }
                const rs = (gains / 14) / (losses / 14 || 1);
                return 100 - (100 / (1 + rs));
            };

            const analyzePattern = (prices) => {
                if (prices.length < 20) return { strength: 0, pattern: 'WAIT', signal: 'HOLD' };
                
                const recent = prices.slice(-20);
                const ma20 = recent.reduce((a, b) => a + b, 0) / 20;
                const ma5 = recent.slice(-5).reduce((a, b) => a + b, 0) / 5;
                const rsi = calculateRSI(recent);

                let strength = 0, pattern = 'NEUTRAL', signal = 'HOLD';

                if (ma5 > ma20 && rsi < 70) {
                    pattern = 'BULLISH';
                    strength = 75;
                    signal = 'BUY';
                } else if (ma5 < ma20 && rsi > 30) {
                    pattern = 'BEARISH';
                    strength = 75;
                    signal = 'SELL';
                }

                return { strength, pattern, signal, rsi };
            };

            const generateMarketData = () => {
                const newData = {};
                const newSignals = [];

                watchlist.forEach(symbol => {
                    const basePrice = 100 + Math.random() * 200;
                    const prices = Array(50).fill(0).map((_, i) => {
                        return basePrice + Math.sin(i / 10) * 20 + (Math.random() - 0.5) * 10;
                    });

                    const lastPrice = prices[49];
                    const analysis = analyzePattern(prices);

                    newData[symbol] = {
                        price: lastPrice.toFixed(2),
                        change: ((lastPrice - basePrice) / basePrice * 100).toFixed(2),
                        high: Math.max(...prices).toFixed(2),
                        low: Math.min(...prices).toFixed(2),
                        analysis
                    };

                    if (analysis.strength > 50) {
                        newSignals.push({
                            symbol,
                            action: analysis.signal,
                            strength: analysis.strength,
                            pattern: analysis.pattern,
                            time: new Date().toLocaleTimeString()
                        });
                    }
                });

                setMarketData(newData);
                setSignals(newSignals);

                setRiskMetrics({
                    sharpe: (Math.random() * 2 + 0.5).toFixed(2),
                    volatility: (Math.random() * 30 + 10).toFixed(1),
                    maxDD: (Math.random() * 20 + 5).toFixed(1),
                    var: (Math.random() * 3 + 1).toFixed(2),
                    posSize: (Math.random() * 3 + 2).toFixed(1)
                });
            };

            const fetchNews = () => {
                setNews([
                    { title: 'Fed Signals Rate Hold', sentiment: 'POSITIVE', impact: 'HIGH' },
                    { title: 'Apple Beats Earnings', sentiment: 'POSITIVE', impact: 'HIGH' },
                    { title: 'Oil Prices Surge', sentiment: 'NEUTRAL', impact: 'MEDIUM' },
                    { title: 'ECB Holds Rates', sentiment: 'NEUTRAL', impact: 'MEDIUM' },
                    { title: 'Tech Sector Downgrade', sentiment: 'NEGATIVE', impact: 'MEDIUM' }
                ]);
            };

            const generateAI = () => {
                if (!aiPrompt.trim()) return;
                const bullish = signals.filter(s => s.action === 'BUY').length;
                const bearish = signals.filter(s => s.action === 'SELL').length;
                const sentiment = bullish > bearish ? 'BULLISH' : 'BEARISH';

                const response = `Market Analysis:\n\nSentiment: ${sentiment}\nBUY Signals: ${bullish}\nSELL Signals: ${bearish}\nSharpe Ratio: ${riskMetrics.sharpe}\nVolatility: ${riskMetrics.volatility}%\nRecommendation: ${sentiment === 'BULLISH' ? 'Accumulate on dips' : 'Reduce exposure'}`;
                
                setAiResponse(response);
                setAiPrompt('');
            };

            const runBacktest = (symbol) => {
                const result = {
                    symbol,
                    return: (Math.random() * 50 + 10).toFixed(2),
                    winRate: (Math.random() * 60 + 40).toFixed(0),
                    sharpe: (Math.random() * 2 + 0.8).toFixed(2),
                    maxDD: (Math.random() * 20 + 5).toFixed(2),
                    trades: Math.floor(Math.random() * 30 + 10)
                };
                setBackTestData(result);
            };

            useEffect(() => {
                generateMarketData();
                fetchNews();
                const timer = setInterval(generateMarketData, 10000);
                return () => clearInterval(timer);
            }, [watchlist]);

            return (
                <div className="min-h-screen bg-gradient-to-b from-gray-950 to-gray-900 text-gray-100">
                    {/* HEADER */}
                    <div className="bg-gradient-to-r from-blue-900 to-purple-900 border-b-2 border-cyan-500 p-6">
                        <div className="max-w-7xl mx-auto flex justify-between">
                            <div>
                                <h1 className="text-4xl font-bold text-cyan-300">üöÄ AI Trading System</h1>
                                <p className="text-gray-300 mt-1">LIVE ‚Ä¢ Multi-Asset ‚Ä¢ AI Powered</p>
                            </div>
                            <div className="text-right">
                                <div className="text-3xl font-bold text-green-400">$100K</div>
                                <div className="text-purple-300">Signals: {signals.length}</div>
                            </div>
                        </div>
                    </div>

                    {/* CONTROLS */}
                    <div className="bg-gray-900 border-b border-gray-700 p-4">
                        <div className="max-w-7xl mx-auto flex gap-2 flex-wrap items-center">
                            <button onClick={() => {setAssetClass('stocks'); setWatchlist(stocks);}} className={`px-3 py-2 rounded border ${assetClass === 'stocks' ? 'bg-cyan-600 border-cyan-400' : 'bg-gray-800 border-gray-600'}`}>üìà Stocks</button>
                            <button onClick={() => {setAssetClass('forex'); setWatchlist(forex);}} className={`px-3 py-2 rounded border ${assetClass === 'forex' ? 'bg-cyan-600 border-cyan-400' : 'bg-gray-800 border-gray-600'}`}>üí± Forex</button>
                            <button onClick={() => {setAssetClass('commodities'); setWatchlist(commodities);}} className={`px-3 py-2 rounded border ${assetClass === 'commodities' ? 'bg-cyan-600 border-cyan-400' : 'bg-gray-800 border-gray-600'}`}>üõ¢Ô∏è Commodities</button>
                            <button onClick={() => {setAssetClass('crypto'); setWatchlist(crypto);}} className={`px-3 py-2 rounded border ${assetClass === 'crypto' ? 'bg-cyan-600 border-cyan-400' : 'bg-gray-800 border-gray-600'}`}>‚Çø Crypto</button>

                            <div className="flex gap-1 ml-auto">
                                {['dashboard', 'signals', 'news', 'ai', 'backtest', 'risk'].map(t => (
                                    <button key={t} onClick={(
